% {{{ Setup
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{g24beamer}[2024/10/17 ver 1.00]
\newcommand*{\genuaisms}{ISMS-Vorgabe: genua intern -- offen}

% Includes

\RequirePackage{g20colors}
\RequirePackage{tikz}
\RequirePackage{changepage}
\RequirePackage{ifthen}
\RequirePackage{fmtcount}
\RequirePackage{contour}
\RequirePackage{pdfrender}
\strictpagecheck
\RequirePackage{pgf}
\RequirePackage[many]{tcolorbox}

% Fonts
%% Mainfont -> WorkSans
%% Monofont -> AnonymousPro

\RequirePackage{iftex}
\expandafter\let\csname g20beamer@usefontspec\endcsname\undefined
\ifluatex
\expandafter\let\csname g20beamer@usefontspec\endcsname\relax
\else
\ifpdftex
\expandafter\let\csname g20beamer@usefontspec\endcsname\relax
\fi\fi
\expandafter\ifx\csname g20beamer@usefontspec\endcsname\relax
  \RequirePackage{fontspec}

  \setmainfont[%
    Path = fonts/ ,
    Extension = .ttf ,
    Ligatures = TeX ,
    UprightFont = *-Light,
    BoldFont = *-Medium,
    ItalicFont = *-LightItalic,
  ]{WorkSans}

  \setmonofont[%
    Path = fonts/ ,
    Extension = .ttf ,
    UprightFont = *-Regular,
    BoldFont = *-Bold,
    ItalicFont = *-Italic,
  ]{AnonymousPro}
\else
  \RequirePackage{g20worksans}
\fi

\renewcommand\familydefault{\rmdefault}
\renewcommand\UrlFont{\color{g20blue}\rmfamily}

\newfontfamily{\fa}[Path=fonts/]{Font-Awesome-6-Free-Solid-900.otf}
\newfontfamily{\fab}[Path=fonts/]{Font-Awesome-6-Brands-Regular-400.otf}
%\newcommand{\faLocationCrossHairs}{\fa \symbol{"F601}}
\newcommand{\fabYoutube}{\fab \symbol{"F167}}
\newcommand{\fabXing}{\fab \symbol{"F169}}
\newcommand{\fabLinkedIn}{\fab \symbol{"F08C}}

\newcommand{\genuatick}[1]{
  \begin{tikzpicture}
    \draw[draw=#1, line width=3pt] (0,1) -- (0,2) -- (1,2) -- (1,1) (0,0) arc(-90:0:1) (0,0) -- (-0.052,0) -| (0,0.3333) arc(-90:0:0.66) [rounded corners=1pt] -- (-0.053,1);
  \end{tikzpicture}
}

\newcommand{\drawBgPattern}[2]{
  %\draw[draw=g20green, line width=3pt] (0,-1) arc(-90:0:1);
  %\draw[draw=g20green, line width=3pt] (0,-0.66) arc(-90:0:0.66);
  %\node (quote) at (1,0) {{\contour{g20green}{\scalebox{10}{\color{none}{\Huge"}}} }};
  \begin{tikzpicture}
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (0*#1, 4*#1) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (1*#1, 5*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (1*#1, 3*#1) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (2*#1, 6*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (2*#1, 4*#1) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (3*#1, 5*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (3*#1, 4*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (3*#1, 3*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (3*#1, 1*#1) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (4*#1, 6*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (4*#1, 4*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (4*#1, 3*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (4*#1, 0) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (5*#1, 6*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (5*#1, 5*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (5*#1, 4*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (5*#1, 2*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (5*#1, 1*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (5*#1, 0) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (6*#1, 6*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (6*#1, 5*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (6*#1, 3*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (6*#1, 2*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (6*#1, 1*#1) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (7*#1, 6*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (7*#1, 5*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (7*#1, 4*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (7*#1, 3*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (7*#1, 2*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (7*#1, 1*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (7*#1, 0) rectangle +(#1-.1, #1-.1);

    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (8*#1, 6*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (8*#1, 5*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (8*#1, 4*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (8*#1, 3*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (8*#1, 2*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=#2, draw=none,          line width=0.5mm}}] (8*#1, 1*#1) rectangle +(#1-.1, #1-.1);
    \draw[draw=none,preaction={clip,postaction={fill=none,          draw=#2, line width=0.5mm}}] (8*#1, 0) rectangle +(#1-.1, #1-.1);
  \end{tikzpicture}
  }

% Farben

\setbeamercolor{section in toc}{fg=g20blue}
%\setbeamerfont{section in toc}{series=\bfseries}
\setbeamercolor{subsection in toc}{fg=g20blue}
\setbeamercolor{section}{fg=g20blue}
\setbeamercolor{frametitle}{fg=g20blue}
\setbeamerfont{frametitle}{size=\large,series=\bfseries}
\setbeamercolor{framesubtitle}{fg=g20blue}
\setbeamerfont{framesubtitle}{size=\scriptsize,series=\mdseries}
\setbeamerfont{title}{size=\Huge,series=\bfseries}
\setbeamercolor{title}{fg=g20blue}
\setbeamerfont{subtitle}{size=\large,series=\mdseries}
\setbeamercolor{title}{fg=g20cleanwhite}
\setbeamercolor{subtitle}{fg=g20cleanwhite}
\setbeamercolor{structure}{fg=g20infoblue}
\setbeamercolor{alert}{fg=g20infored}
% }}}

\setbeamertemplate{section in toc}{
  {\color{g20green}\texttt{\two@digits{\inserttocsectionnumber}}}\quad\inserttocsection
}

\setbeamertemplate{subsection in toc}{
    \ifnum\inserttocsubsectionnumber=1
    ~~{\color{g20green}\texttt{\quad\inserttocsubsectionnumber}}\quad\inserttocsubsection\newline
    \else
    ~{\color{g20green}\texttt{\quad\inserttocsubsectionnumber}}\quad\inserttocsubsection\newline
    \fi
}

% {{{ Hintergrund

\defbeamertemplate*{background canvas}{title}{%
	\begin{tikzpicture}[remember picture]
    \fill[shading=axis, left color=g20blue, right color=g20blue!20!g20violet, shading angle=135] (0,0) rectangle (\paperwidth,\paperheight);

    \begin{scope}%[shift={(8.3,0.7)}]
      \node[opacity=0.2] at(11.8,3.7) {\drawBgPattern{0.8}{g20cleanwhite}};
    \end{scope}

		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{title-logo}};
	\end{tikzpicture}
}

\defbeamertemplate*{background canvas}{quote}{%
	\begin{tikzpicture}[remember picture]
    \fill[color=g20cleanwhite] (0,0) rectangle (\paperwidth,\paperheight);

    \begin{scope}[shift={(1.5,5.8)}]
      \node[opacity=0.2] {\genuatick{g20violet}};
    \end{scope}
    \begin{scope}[shift={(3.16,5.8)}]
      \node[opacity=0.2] {\genuatick{g20violet}};
    \end{scope}

		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{logo}};
	\end{tikzpicture}
}

\defbeamertemplate*{background canvas}{alt-title}{%
	\begin{tikzpicture}[remember picture]
    \fill[color=g20blue] (0,0) rectangle (\paperwidth,\paperheight);

    \begin{scope}[shift={(8.3,0.7)}]
      \node[opacity=0.2] at(11.8,3.7) {\drawBgPattern{0.8}{g20cleanwhite}};
    \end{scope}

		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{title-logo}};
	\end{tikzpicture}
}

\defbeamertemplate*{background canvas}{tocframe}{%
	\begin{tikzpicture}
    \fill[color=g20cleanwhite] (0,0) rectangle (\paperwidth,\paperheight);
    \fill[color=g20blue] (-6,0.7) rectangle (-0.8,\paperheight);

    \node[opacity=0.2,yscale=-1] at (-2,4.5) {\drawBgPattern{0.8}{g20cleanwhite}};

		\node[inner sep=0pt] (logo) at (8.4, 8.35) {\pgfuseimage{logo}};
	\end{tikzpicture}
}


\defbeamertemplate*{background canvas}{closing}{%
	\begin{tikzpicture}[remember picture]
    \fill[color=g20cleanwhite] (0,0) rectangle (\paperwidth, \paperheight);

    \begin{scope}[shift={(8.3,0.7)}]
      \node[opacity=0.2] at(11.8,3.7) {\drawBgPattern{0.8}{g20cleanwhite}};
    \end{scope}

		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{logo}};
	\end{tikzpicture}
}

% }}}

% {{{ Templates

% itemize

\setbeamertemplate{itemize item}{\color{g20blue}\raisebox{0.25ex}{\tiny$\bullet$}}
\setbeamertemplate{itemize subitem}{\color{g20blue}\raisebox{0.25ex}{\tiny$\bullet$}}
\setbeamertemplate{itemize subsubitem}{\color{g20blue}\raisebox{0.25ex}{\tiny$\bullet$}}

% Logo
\pgfdeclareimage[interpolate=true,width=2cm]{logo}{pics/genua-logo-screen-RGB.pdf}
\pgfdeclareimage[interpolate=true,width=2cm]{title-logo}{pics/genua-logo-weiss.pdf}

% Fusszeile
\beamertemplatenavigationsymbolsempty

\defbeamertemplate*{footline}{title}{
  \hskip0.5cm{\scriptsize\usebeamercolor[fg]{subtitle}\insertauthor\hfill\insertdate\hskip0.6cm~}\vskip5pt
}

\defbeamertemplate*{footline}{pages}{
  \hskip0.5cm{\tiny\upshape \insertshorttitle\ifx\genuaisms\empty\else~|~\genuaisms\fi\quad}
	\hfill{\scriptsize\insertpagenumber\quad~}\vskip5pt
}
\setbeamertemplate{footline}[pages]
\setbeamertemplate{frametitle}{
  \vspace{1cm}
  \insertframetitle\newline
  \scriptsize\insertframesubtitle
}

%\setbeamertemplate{blocks}[squared]
\useinnertheme[rounded=false]{tcolorbox}
\setbeamercolor{block title}{fg=g20blue, bg=g20green}
\setbeamercolor{block body}{fg=g20blue, bg=g20green}

\newenvironment{important}{
\begin{block}{}
  \scalebox{0.25}{
  \begin{tikzpicture}
    \draw[line width=6pt, draw=g20yellow] (0,0) -- (1,0.5) -- (0,1);
    \draw[line width=6pt, draw=g20yellow] (0.8,0) -- (1.8,0.5) -- (0.8,1);
  \end{tikzpicture}
}
  ~
}{
\end{block}
}

% Titelseite

\setbeamertemplate{title page}{%
  \setbeamertemplate{background canvas}[title]
	%\begin{minipage}[t][2cm][t]{0.225\textwidth}
	%	~
	%\end{minipage}
  \vskip3cm
	\begin{minipage}[t][][t]{0.75\textwidth}
    \usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle\par
		\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par
	\end{minipage}
}

% Toc

\defbeamertemplate*{background canvas}{section}{%
	\begin{tikzpicture}[remember picture]
		\fill[color=g20cleanwhite] (0,0) rectangle (\paperwidth,\paperheight);
		\fill[color=g20blue] (0, 4.5) rectangle (\paperwidth, \paperheight);
		\fill[color=g20violet] (0, 4.5) rectangle (.5*\paperwidth, 0.75*\paperheight);
		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{title-logo}};
	\end{tikzpicture}
}

% Socials

\newcommand{\socials}{
  \begin{frame}[socials]
    \vspace{2cm}
    \color{g20blue}
    {\huge\textbf{Excellence in\\[0.1cm] Digital Security}}\\[0.75cm]
    {\scriptsize
    \textbf{genua GmbH}\newline
    Domagkstr. 7\newline
    85551 Kirchheim bei München\\[0.1cm]
    +49 89 991950-0\newline
    \url{info@genua.de}\\[0.1cm]
    \textbf{\url{www.genua.de}}\\[0.6cm]
    }
    \href{https://www.youtube.com/@genuanews}{\color{g20blue}\huge\fabYoutube}\quad
    \href{https://www.xing.com/pages/genuagmbh}{\color{g20blue}\huge\fabXing}\quad
    \href{https://de.linkedin.com/company/genua-gmbh}{\color{g20blue}\huge\fabLinkedIn}\quad
    \end{frame}
}

\defbeamertemplate*{background canvas}{socials}{%
	\begin{tikzpicture}[remember picture]
		\fill[color=g20cleanwhite] (0,0) rectangle (\paperwidth,\paperheight);

    \begin{scope}%[shift={(8.3,0.7)}]
      \node[opacity=0.2] at(11.8,3.7) {\drawBgPattern{0.8}{g20green}};
    \end{scope}
		
    %\node at (1,4) {\Huge{Excellence in\newline Digital Security}};
    %\node at (1,2) {\textbf{genua GmbH}\newline Domagkstr. 7\newline 85551 Kirchheim bei München\newline\newline+49 89 991950-0\newline info@genua.de\newline\newline\url{www.genua.de}};
		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{logo}};
	\end{tikzpicture}
}

\define@key{beamerframe}{socials}[true]{
  \setbeamertemplate{background canvas}[socials]
}

% Frame-Keys

\define@key{beamerframe}{sectionframe}[true]{
  \setbeamertemplate{background canvas}[section]
  \setbeamercolor{frametitle}{fg=g20blue}
  \setbeamerfont{section title}{size=\Huge}
  \setbeamercolor{section title}{fg=g20blue}
  %\setbeamertemplate{headline}[white]
  \setbeamertemplate{footline}[section]
}

\define@key{beamerframe}{tocframe}[true]{
  \setbeamertemplate{background canvas}[tocframe]
  \setbeamercolor{frametitle}{fg=g20blue}
  \setbeamerfont{section title}{size=\Huge}
  \setbeamercolor{section title}{fg=g20blue}
  %\setbeamertemplate{headline}[white]
  \setbeamertemplate{footline}[section]
  \setlength{\leftskip}{5cm}
}

\define@key{beamerframe}{quoteframe}[true]{
  \setbeamertemplate{background canvas}[quote]
  \setbeamercolor{frametitle}{fg=g20blue}
  %\setbeamertemplate{headline}[white]
}

% default-layout

%\let\origtableofcontents\tableofcontents

\newcommand*{\createsectionpage}{
%  \let\insertsectionnumber\relax
%  \let\sectionname\relax
  %\let\thesection\relax
  \begin{frame}[sectionframe]
    \begin{tikzpicture}[overlay]
      \draw[draw=none] (0,0) rectangle (\paperwidth,\paperheight);
      \node[anchor=east] (sectionnum) at (8, 0.3) {\scalebox{1.5}{\Huge\color{g20cleanwhite}{\texttt{\two@digits{\thesection}}}\quad}};
      \node[anchor=west] (section) at (-0.6,-3.5) {\Huge\textbf\insertsection};
    \end{tikzpicture}
	  %\sectionpage
  \end{frame}
}

\newcommand{\slidestyle}{default}
\newcommand{\setslidestyle}[1]{% enable style selection currently "default"
	\renewcommand{\slidestyle}{#1}
}

% Raender
\newcommand{\defaultrightmargin}{3.5cm}
\newcommand{\plainrightmargin}{1.5cm}

\defbeamertemplate*{background canvas}{plain}{%
	\begin{tikzpicture}[remember picture]
		\fill[color=g20cleanwhite] (0,0) rectangle (\paperwidth,\paperheight);
		\node[inner sep=0pt] (logo) at (14.4, 8.35) {\pgfuseimage{logo}};
	\end{tikzpicture}
}

\define@key{beamerframe}{plain}[true]{
  \setbeamertemplate{background canvas}[plain]
  \setbeamertemplate{footline}[pages]
}

\BeforeBeginEnvironment{frame}{%
	\setbeamercolor{frametitle}{fg=g20blue}
  \ifnum \theframenumber=0 % check for titleframe
	\setbeamertemplate{background canvas}[title]
	\setbeamertemplate{headline}[title]
	\setbeamertemplate{footline}[title]
  \else
    \setbeamertemplate{headline}[default]
    \ifthenelse{\equal{\slidestyle}{default}}{
       \setbeamertemplate{background canvas}[plain]
       \setbeamertemplate{footline}[pages]
     }{
     \ifthenelse{\equal{\slidestyle}{blue}}{
       \setbeamertemplate{background canvas}[blue]
       \setbeamertemplate{footline}[pages]
     }{
       \setbeamertemplate{background canvas}[green]
       \setbeamertemplate{footline}[pages]
     }}
  \fi
}

% }}}

\BeforeBeginEnvironment{frame}{
  \setlength{\leftskip}{0pt}
}

\mode<all>
